<!-- Time-stamp: "2025-01-07 09:48:16 (ywatanabe)" -->
<!-- File: README.md -->
<!-- ---
!-- title: 2025-01-06 12:14:35
!-- author: ywata-note-win
!-- date: /home/ywatanabe/proj/llemacs/README.md
!-- --- -->

# Llemacs â€” LLM Agents on Emacs
<img src="./docs/logo/llemacs.gif" width="100" alt="Llemacs Logo">
Llemacs is a file-based LLM agent system implemented in Elisp

## Features
- [x] Multiple LLM provider support (Anthropic/Google/DeepSeek)
- [x] Structured logging with SQLite and file-based systems
- [x] Template-based prompt management
- [x] Mermaid-based project visualization
- [x] Containerized execution via Apptainer
- [ ] Version control integration
- [ ] Capture user corrections
- [ ] Learning Mechanism
  - Store successful patterns
  - PR feedback as metrics
    ```python
    class PRMetrics:
        def __init__(self):
            self.attempts = 0
            self.accepted = 0
            self.reviews = []

        def record_attempt(self, pr_data):
            self.attempts += 1
            if pr_data['accepted']:
                self.accepted += 1
            self.reviews.append(pr_data['comments'])

        def get_success_rate(self):
            return self.accepted / self.attempts if self.attempts > 0 else 0
    ```

    A prompt hub with voting could work like this:

    1. Structure
    ```python
    class PromptComponent:
        def __init__(self, content, category):
            self.content = content
            self.category = category
            self.votes = 0
            self.usages = 0
            self.success_rate = 0.0
            self.versions = []

    class PromptHub:
        def __init__(self):
            self.components = {}
            self.ranking = {}

        def submit(self, component):
            self.components[component.id] = component

        def vote(self, component_id, score):
            self.components[component_id].votes += score
            self.update_ranking()

        def get_top_prompts(self, category):
            return sorted(
                [c for c in self.components.values() if c.category == category],
                key=lambda x: (x.votes, x.success_rate),
                reverse=True
            )
    ```

    2. Benefits
    - Community-driven evolution
    - Real-world validation
    - Automatic quality filtering
    - Version competition

    3. Integration Points
    - GitHub API for PR stats
    - User feedback collection
    - Automated testing results
    - Usage statistics

- Link components dynamically



## Disclaimer
- This repository is under active development
- The system is not yet fully functional yet
- Although Apptainer restricts agent access to the [`./workspace`](./workspace) directory, we assume no responsibility for any unintended file modifications.

## Usage

[`./examples/automatic-project-development.md`](./examples/automatic-project-development.md)

## Installation
### 1. Elisp Setup
``` elisp
(load-file (expand-file-name "/path/to/llemacs/llemacs.el/llemacs.el"))
(require 'llemacs)
```
### 2. Python Environment

``` bash
python -m venv ./workspace/.env
source ./workspace/.env/bin/activate
python -m pip install -r requirements.txt
```

### 3. Environment Variables
Details can be seen at [`./config/env/`](./config/env/).
For example, LLM API keys are expected as follows:
```bash
# LLM
export LLEMACS_ANTHROPIC_API_KEY="your-key" # Default: $ANTHROPIC_API_KEY
export LLEMACS_GOOGLE_API_KEY="your-key" # Default: $GOOGLE_API_KEY
export LLEMACS_DEEPSEEK_API_KEY="your-key" # Default: $DEEPSEEK_API_KEY

# Git
export LLEMACS_GIT_EMAIL="your-agent-email-address"
export LLEMACS_GIT_USER_NAME="your-agent-name"
export LLEMACS_GIT_GITIGNORE_PATH="dot-gitignore-path"
```
`(llemacs-llm-switch-provider)` switches the LLM provider to use.

### 4. Mermaid
Please see [`./docs/installation/mermaid.md`](./docs/installation/mermaid.md).


## Architecture
<a href="./docs/project_flow/project_flow.svg">
    <img src="./docs/project_flow/project_flow.gif" alt="Project Flow" width="800">
</a>

Generated by mermaid ([source](./docs/project_flow/project_flow.mmd)), which will be helpful for both users and agents.

## Security

## Permission control via Apptainer

Apptainer provides permission control by restricting agent access to the workspace directory only.

``` bash
main -m build  # Create sandbox
main -m shell  # Enter sandbox
main -m run    # Launch Emacs as an agent
```

## Contact
- support@llemacs.com
- Yusuke.Watanabe@unimelb.edu.au
