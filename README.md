<!-- ---
!-- title: 2025-01-03 03:42:09
!-- author: Yusuke Watanabe
!-- date: /home/ywatanabe/proj/llemacs/README.md
!-- --- -->

# Llemacs â€” LLM Agents on Emacs
<img src="./docs/logo/llemacs.gif" width="100" alt="Llemacs Logo">
Llemacs is a file-based LLM agent system implemented in Elisp

## Features
- [x] Multiple LLM provider support (Anthropic/Google/DeepSeek)
- [x] Structured logging with SQLite and file-based systems
- [x] Template-based prompt management
- [x] Mermaid-based project visualization
- [x] Containerized execution via Apptainer
- [ ] Version control integration
 
## Disclaimer
- This repository is under active development
- The system is not yet fully functional yet
- Although Apptainer restricts agent access to the [`./workspace`](./workspace) directory, we assume no responsibility for any unintended file modifications.

## Installation
### 1. Elisp Setup
``` elisp
(load-file (expand-file-name "/path/to/llemacs/llemacs.el/llemacs.el"))
(require 'llemacs)

;; Basic Usage
(llemacs--run-elisp `(message "hi")) ;; Run Elisp code with logging
(llemacs--llm-prompt-compile "code-gen") ;; Compile prompt template (recipe-id: "code-gen")
(llemacs--llm-prompt-embed "plot something" "code-gen") ;; Embed the prompt to template (recipe-id: "code-gen")
(llemacs--run-prompt "plot something" "code-gen") ;; Translate prompt to elisp code and evaluate
(llemacs--proj-init "dsp-project" "Write digital signal processing code for demo EEG signals, like calculating DMD features") ;; project-name, goals
(llemacs--run-prompt (llemacs--proj-collect-context "039-dsp-project")  "report-gen") ;; Generate report based on he goals
```
### 2. Python Environment

``` bash
python -m venv ./workspace/.env
source ./workspace/.env/bin/activate
python -m pip install -r requirements.txt
```

### 3. Environment Variables
Details can be seen at [`./config/env/`](./config/env/).
For example, LLM API keys are expected as follows:
```bash
export LLEMACS_ANTHROPIC_API_KEY="your-key" # Default: $ANTHROPIC_API_KEY
export LLEMACS_GOOGLE_API_KEY="your-key" # Default: $GOOGLE_API_KEY
export LLEMACS_DEEPSEEK_API_KEY="your-key" # Default: $DEEPSEEK_API_KEY
```
`(llemacs-llm-switch-provider)` switches the LLM provider to use.


### 4. Mermaid
Please see [`./docs/installation/mermaid.md`](./docs/installation/mermaid.md).


## Architecture
<a href="./docs/project_flow/project_flow.png">
    <img src="./docs/project_flow/project_flow.gif" alt="Project Flow" width="800">
</a>

Generated by mermaid ([source](./docs/project_flow/project_flow.mmd)), which will be helpful for both users and agents.

## Security

## Permission control via Apptainer

Apptainer provides permission control by restricting agent access to the workspace directory only.

``` bash
main -m build  # Create sandbox
main -m shell  # Enter sandbox
main -m run    # Launch Emacs as an agent
```

<!-- ## Project Structure
 !-- - `llemacs.el/` - Main Elisp implementation
 !--   - `01-llemacs-base/` - Core functionality
 !--   - `02-llemacs-logging/` - Logging system
 !--   - `03-llemacs-llm/` - LLM integration
 !--   - `04-llemacs-cvt/` - Format converters
 !--   - `05-llemacs-run/` - Execution system
 !-- 
 !-- See full structure: [./docs/workspace_tree.txt](./docs/workspace_tree.txt)
 !-- <\!-- tree workspace > ./docs/workspace_tree.txt -\-> -->

## Contact
- support@llemacs.com
- Yusuke.Watanabe@unimelb.edu.au